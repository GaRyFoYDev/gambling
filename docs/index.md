- [Project description](#project-description)
- [Usage](#usage)
- [Data](#data)
- [Preprocessing](#preprocessing)
- [Excel file](#excel-file)
- [Contact](#contact)


## Project description
This project aims to analyze data on the revenue generated by online games licensed by the ANJ in France, including sports betting, horse racing betting, and poker. The analysis includes data extraction, cleaning, and visualization to understand trends and performance in the online gaming market in the country.


## Usage
1. Download the data from the [ANJ](https://anj.fr/open-data-anj) website.
2. Place the data files in the `data/` directory.
3. Run the `main.py` script to start the analysis.

```bash
   python main.py
```

   
## Data
The data used in this project is provided by data.gouv.fr. It includes information on daily revenue from sports betting, horse racing betting, and online poker in France, as well as contextual data such as date and game type.

## Preprocessing
The data preprocessing includes the following steps:


1. Set index: Set the index of the DataFrame to 'Catégorie/Année'.
2. Transpose table: transpose the DataFrame.
3. Slice dataFrame: Keep only the first 33 columns because the rest does not contains values
4. Update index: Extract years from the index and replace it.
5. Rename columns: Rename specific columns for clarity and consistency.
6. Process numeric columns (0 to 17):
      * Remove spaces between numbers.
      * Replace NaN values with 0.
      * Convert string values to integers.
7. Process percentage columns (18 to end):
      * Remove '%' symbols.
      * Replace NaN values with 0.
      * Convert string values to floats.
      * Divide values by 100 to represent proportions.
8. Calculate average distribution for different categories:
      * Calculate the average distribution of bets by gender, device, and betting type.
      * Round the values to one decimal place.
9. Return a clean DataFrame.

These steps ensure that the data is cleaned, standardized, and ready for analysis.


## Excel file
1. Import libraries
      * Import pandas for data manipulation.
      * Import xlsxwriter for creating Excel files.
      * Import Union and Tuple from typing for type hinting.
2. Define Chart Series Data
      * Define dictionaries containing data for different chart series. Each dictionary specifies the name, categories, values, and other properties for a specific chart series. These dictionaries will be used to create various charts in the Excel workbook.
3. Define Column Lists
      *  Create lists of column names to be used for computing aggregated values. These lists include:
         - cja_lst: Columns related to the number of CJA (Compte Joueur Actif / Active Player Account).
         - mise_lst: Columns related to betting amounts in different categories.
         - pbj_lst: Columns related to gross gaming revenue (PBJ: Produit Brut des Jeux).
         - sports_lst: Columns related to the distribution of bets across different sports.
4. Define helper functions
      * create_chart Function
        -  Creates a chart in the specified workbook and worksheet. The function takes various parameters, including chart type, series data, title, labels, size, and subtype. It inserts the chart into the specified area of the worksheet.
  
      * autosize Function
        - Automatically adjusts the column widths in an Excel worksheet based on the length of the data in each column.
  
      * compute_data Function
        - Computes aggregated values (sum or mean) for specified columns in a DataFrame. The function can compute the mean of rows, sum of rows, or mean of columns, depending on the specified computation type.
  
5. Define main function to create the excel file

      * create_xls_file Function
        - Writes the DataFrame to an Excel sheet named 'data'.
        - Adjusts the column widths in the 'data' sheet using the autosize function.
        - Adds a new worksheet named 'dashboard'.
        - Creates various charts using the create_chart function, including line charts, column charts, pie charts, and bar charts. Each chart visualizes different aspects of the gambling data, such as the number of operators, number of CJA, betting amounts, and gross gaming revenue.
        - Computes additional data needed for the dashboard, such as the mean number of CJA, total betting amounts, total PBJ, and PBJ/mise ratio.
        - Creates a table on the dashboard with the computed data.
        - Computes the distribution of bets across different sports and creates a pie chart to visualize this distribution.
        - Creates bar charts to visualize the distribution of bets between men and women, and between different devices (smartphones/tablets vs. computers).
  
By following these steps, the code generates an Excel file named 'gambling.xlsx' with a 'data' sheet containing the original data and a 'dashboard' sheet with various charts and tables that provide a comprehensive overview of the gambling data.

## Contact
For any questions or comments, please contact [Gary FOY](mailto:garyfoy@hotmail.fr).








